addons:
  apt:
    packages:
    - zsh
    - ncurses-dev
    - autoconf
    - yodl
    - man
dist: trusty
language: generic
cache:
  apt: true
  directories:
  - "$HOME/.zvm"
jobs:
  include:
  - stage: linux
    os: linux
    env: ZVM_VERSION='4.3.12'
  - os: linux
    env: ZVM_VERSION='4.3.17'
  - os: linux
    env: ZVM_VERSION='5.0.8'
  - os: linux
    env: ZVM_VERSION='5.1.1'
  - os: linux
    env: ZVM_VERSION='5.2'
  - os: linux
    env: ZVM_VERSION='5.3.1'
  - stage: mac os
    os: osx
    env: ZVM_VERSION='5.0.8'
  - os: osx
    env: ZVM_VERSION='5.1.1'
  - os: osx
    env: ZVM_VERSION='5.2'
  - os: osx
    env: ZVM_VERSION='5.3.1'
  - stage: deploy
    script: skip
before_script:
- if [[ $(ls "$HOME/.zvm" | wc -l) -eq 0 ]]; then rm -rf "$HOME/.zvm"; fi
- mkdir .bin
- curl -L https://raw.githubusercontent.com/molovo/revolver/master/revolver > .bin/revolver
- curl -L https://raw.githubusercontent.com/molovo/color/master/color.zsh > .bin/color
- curl -L https://raw.githubusercontent.com/molovo/zvm/master/zvm > .bin/zvm
- chmod u+x .bin/{color,revolver,zvm}
- export PATH="$HOME/.zvm/bin:$PWD/.bin:$PATH"
- git clone https://github.com/MenkeTechnologies/zunit
- cd zunit
- zvm use ${ZVM_VERSION}
- "./build.zsh"
- export PATH="$PWD:$PATH"
- cd ..
script: "zunit tests/*.zsh"
notifications:
  email: false
